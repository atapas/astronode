---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Posts from '../../components/Posts.astro';
import {getAllPosts} from '../../data/blog-data';

export async function getStaticPaths() {
  const data = await getAllPosts();
  const allPosts = data.publication.posts.edges;
  
  console.log(allPosts);

  const allTags = [...new Set(allPosts.map((post) => post.node.tags).flat())];
  const jsonObject = allTags.map(JSON.stringify);
  const uniqueSet = new Set(jsonObject);
  const uniqueTags = Array.from(uniqueSet).map(JSON.parse);
  //console.log(uniqueTags)

  return uniqueTags.map((tag: any) => {
    return {params: { tag: tag.slug }}
  })
}

const { tag } = Astro.params;

console.log(tag);

---
